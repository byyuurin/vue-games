var P=Object.defineProperty,V=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var F=(t,e,n)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,w=(t,e)=>{for(var n in e||(e={}))L.call(e,n)&&F(t,n,e[n]);if(D)for(var n of D(e))q.call(e,n)&&F(t,n,e[n]);return t},E=(t,e)=>V(t,H(e));import{d as U,e as M,o as g,c as h,F as k,t as p,u as l,i as I,f as G,n as z,g as J,r as K,h as O,a as c,j as A,b as N,k as Q,m as R,w as T}from"./assets/index.b9497a9c.js";const W=["disabled"],X={key:0,"i-mdi-flag":"","text-red-500":""},Y={key:1,"i-mdi-mine":""},Z={key:2},ee={key:0,text:"gray-500/50","i-mdi-mine":""},te={key:1,text:"gray-500/50","i-mdi-flag":"","text-red-500":""},ne={key:2,text:"gray-500/50"},se=U({props:{counts:{default:0},dangered:{type:Boolean},flagged:{type:Boolean},viewed:{type:Boolean},disabled:{type:Boolean}},setup(t){const e=t,n=M(()=>{const o=[],u=["text-transparent","text-indigo-600","text-blue-600","text-teal-600","text-green-600","text-yellow-600","text-amber-600","text-orange-600","text-red-600"];return e.viewed?e.dangered?o.push("bg-red-500/50"):o.push(u[e.counts]):(o.push("bg-gray-500"),e.flagged||o.push("hover:bg-opacity-20 active:bg-opacity-25")),o});return(o,u)=>(g(),h("button",{m:"1px",border:"0.5 gray-400/10","bg-opacity-10":"","inline-block":"","min-w-10":"","min-h-10":"","rounded-sm":"",flex:"","justify-center":"","items-center":"","text-xl":"","font-bold":"","select-none":"","disabled:pointer-events-none":"",disabled:t.disabled,class:z(l(n))},[t.viewed||t.flagged?(g(),h(k,{key:0},[t.flagged?(g(),h("i",X)):t.dangered?(g(),h("i",Y)):(g(),h("span",Z,p(t.counts),1))],64)):l(I)?(g(),h(k,{key:1},[t.dangered?(g(),h("i",ee)):t.flagged?(g(),h("i",te)):(g(),h("span",ne,p(t.counts),1))],64)):G("",!0)],10,W))}});function C(t,e,n){const{x:o,y:u}=e,f=t.value.board[u][o];t.value.board[u][o]=w(w({},f),n)}function $(t,e){const{width:n,height:o}=l(e);return[[1,1],[1,0],[1,-1],[0,1],[0,-1],[-1,1],[-1,0],[-1,-1]].map(([f,m])=>({x:t.x+f,y:t.y+m})).filter(({x:f,y:m})=>f>=0&&f<n&&m>=0&&m<o)}function j(t,e,n){e.viewed||(!e.dangered&&!e.flagged&&C(t,e.position,{viewed:!0}),e.counts===0&&$(e.position,n).forEach(o=>{const u=t.value.board[o.y][o.x];j(t,u,n)}))}function S(t){const{width:e,height:n}=l(t);return Array.from({length:n}).map((o,u)=>Array.from({length:e}).map((f,m)=>({position:{x:m,y:u},counts:0})))}function ae(t,e,n){const{width:o,height:u,mines:f,friendly:m=!1}=l(e),_=$(n,e).concat(n),x=[],y=()=>x.splice(Math.floor(Math.random()*x.length),1)[0],a=i=>_.filter(({x:d,y:v})=>i.x===d&&i.y===v).length>0,s=i=>{$(i,e).forEach(d=>{const{counts:v}=t.value.board[d.y][d.x];C(t,d,{counts:v+1})})};for(let i=0;i<u;i++)for(let d=0;d<o;d++)m&&a({x:d,y:i})||x.push({x:d,y:i});let r=0;for(;r<f;){const i=y();C(t,i,{dangered:!0}),s(i),r++}}function oe(t){const e=J("minesweeper-state",{timestamp:{begin:0,end:0},status:null,board:S(t)}),n=M(()=>{const{width:a,height:s}=l(t),{timestamp:r}=l(e);let i=a*s,d=0,v=0;return e.value.board.forEach(B=>B.forEach(b=>{if(d+=b.flagged?1:0,b.viewed||b.dangered&&b.flagged)return i--;if(b.dangered)return v++})),{started:r.begin>0,flags:d,dangers:v,unknowns:i,unusedFlags:l(t).mines-d}}),o=a=>l(e).board[a.y][a.x],u=()=>{e.value.board=S(t),n.value.started&&(e.value.status=null,e.value.timestamp={begin:0,end:0})},f=a=>{e.value.status=a,e.value.board.forEach(s=>s.forEach(r=>{r.viewed=r.viewed||r.dangered,r.disabled=!0})),e.value.timestamp.end=Date.now()},m=()=>{const{started:a,dangers:s,unknowns:r}=l(n);if(!!a&&(s===0||s===r))return f("win")};return{state:e,dashboard:n,reset:u,uncover:a=>{n.value.started||(ae(e,t,a),e.value.timestamp.begin=Date.now());const s=o(a);if(!e.value.status&&!s.flagged){if(s.dangered)return f("lose");j(e,s,t),m()}},autoUncover:a=>{const s=o(a);if(e.value.status||!s.viewed)return;const r=$(s.position,t).map(d=>o(d));let i=0;r.forEach(d=>{d.dangered&&!d.flagged&&i++}),i===0&&r.forEach(d=>j(e,d,t)),m()},mark:a=>{const{mines:s}=l(t),r=o(a);e.value.status||r.viewed||n.value.flags>=s&&!r.flagged||(C(e,a,{flagged:!r.flagged}),m())}}}const ie={"py-8":""},re=c("h2",{text:"5xl center ellipsis","mb-6":"","overflow-hidden":""}," Minesweeper ",-1),de={flex:"~ wrap gap-2","justify-center":""},le=c("button",{btn:"",disabled:""}," Customize ",-1),ue={"text-center":""},ce={"p-6":"","text-2xl":"",flex:"~ gap-4","justify-center":"","items-center":""},fe={flex:"~ gap-1","justify-center":"","items-center":""},ge=c("i",{"i-mdi-clock-time-twelve-outline":""},null,-1),me={flex:"~ gap-1","justify-center":"","items-center":""},he=c("i",{"i-mdi-mine":""},null,-1),ve={relative:"","inline-block":"","max-w-full":"","overflow-auto":""},be={key:0,absolute:"","top-0":"","left-0":"","right-0":"","bottom-0":"",flex:"","justify-center":"","items-center":"",bg:"gray-50/50 dark:dark-50/50"},ye=U({setup(t){const e={easy:{width:8,height:8,mines:10},medium:{width:16,height:16,mines:40},hard:{width:16,height:30,mines:99}},n=K(E(w({},e.easy),{friendly:!0})),o=oe(n),{state:u,dashboard:f}=o,m=O(),_=M(()=>{const{begin:a,end:s}=u.value.timestamp;let r=0;return a&&s&&(r=s-a),a&&!s&&(r=+m.value-a),(r/1e3).toFixed(1)});function x(a){const{counts:s,dangered:r,flagged:i,viewed:d,disabled:v}=a;return{counts:s,dangered:r,flagged:i,viewed:d,disabled:v}}function y(a){const{friendly:s}=l(n.value);switch(a){case"easy":case"medium":case"hard":n.value=E(w({},e[a]),{friendly:s});break;default:n.value=a}o.reset()}return(a,s)=>{const r=se;return g(),h(k,null,[c("div",ie,[re,c("div",de,[c("button",{btn:"~ sky",onClick:s[0]||(s[0]=i=>y(n.value))}," New Game "),c("button",{btn:"",onClick:s[1]||(s[1]=i=>y("easy"))}," Easy "),c("button",{btn:"",onClick:s[2]||(s[2]=i=>y("medium"))}," Medium "),c("button",{btn:"",onClick:s[3]||(s[3]=i=>y("hard"))}," Hard "),le])]),c("div",ue,[c("div",ce,[c("div",fe,[ge,c("span",null,p(l(_)),1)]),c("div",me,[he,c("span",null,p(l(f).unusedFlags),1)])]),c("div",ve,[(g(!0),h(k,null,A(l(u).board,(i,d)=>(g(),h("div",{key:d,flex:"~ gap-0","justify-center":""},[(g(!0),h(k,null,A(i,(v,B)=>(g(),Q(r,R({key:B},x(v),{onClick:b=>l(o).uncover(v.position),onDblclick:b=>l(o).autoUncover(v.position),onContextmenu:T(b=>l(o).mark(v.position),["prevent"])}),null,16,["onClick","onDblclick","onContextmenu"]))),128))]))),128)),l(u).status?(g(),h("div",be,[c("span",{text:"8xl shadow","select-none":"",class:z({"text-white/10 dark:text-white/20":l(u).status==="lose","text-orange-400/50 dark:text-orange-400/50":l(u).status==="win"})},p(l(u).status.toUpperCase()),3)])):G("",!0)])])],64)}}});typeof N=="function"&&N(ye);export{ye as default};
