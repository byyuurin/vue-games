var I=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var N=(s,e,n)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,w=(s,e)=>{for(var n in e||(e={}))Q.call(e,n)&&N(s,n,e[n]);if(G)for(var n of G(e))R.call(e,n)&&N(s,n,e[n]);return s},B=(s,e)=>J(s,K(e));import{d as T,e as _,o as v,c as b,F as j,t as p,u as a,i as X,f as q,n as L,g as Y,r as M,h as Z,a as u,j as A,w as k,v as O,k as E,l as V,m as ee,b as H,p as te,q as ne,s as se,x as oe}from"./assets/index.82a38402.js";const ie=["disabled"],ae={key:0,"i-mdi-flag":"","text-red-500":""},le={key:1,"i-mdi-mine":""},re={key:2},de={key:0,text:"gray-500/50","i-mdi-mine":""},ue={key:1,text:"gray-500/50","i-mdi-flag":"","text-red-500":""},ce={key:2,text:"gray-500/50"},ge=T({props:{counts:{default:0},dangered:{type:Boolean},flagged:{type:Boolean},viewed:{type:Boolean},disabled:{type:Boolean}},setup(s){const e=s,n=_(()=>{const o=[],l=["text-transparent","text-indigo-600","text-blue-600","text-teal-600","text-green-600","text-yellow-600","text-amber-600","text-orange-600","text-red-600"];return e.viewed?e.dangered?o.push("bg-red-500/50"):o.push(l[e.counts]):(o.push("bg-gray-500"),e.flagged||o.push("hover:bg-opacity-20 active:bg-opacity-25")),o});return(o,l)=>(v(),b("button",{m:"1px",border:"0.5 gray-400/10","bg-opacity-10":"","inline-block":"","min-w-10":"","min-h-10":"","rounded-sm":"",flex:"","justify-center":"","items-center":"","text-xl":"","font-bold":"","select-none":"","disabled:pointer-events-none":"",disabled:s.disabled,class:L(a(n))},[s.viewed||s.flagged?(v(),b(j,{key:0},[s.flagged?(v(),b("i",ae)):s.dangered?(v(),b("i",le)):(v(),b("span",re,p(s.counts),1))],64)):a(X)?(v(),b(j,{key:1},[s.dangered?(v(),b("i",de)):s.flagged?(v(),b("i",ue)):(v(),b("span",ce,p(s.counts),1))],64)):q("",!0)],10,ie))}});function fe(s,e,n){let{flags:o,dangers:l,unknowns:g}=a(s);"flagged"in n&&(o+=e.flagged?-1:1),"flagged"in n&&e.dangered&&(g-=n.flagged?1:-1,l-=n.flagged?1:-1),"viewed"in n&&!e.viewed&&g--,"dangered"in n&&(l+=n.dangered?1:-1),s.value={flags:o,dangers:l,unknowns:g}}function z(s,e,n,o){const{x:l,y:g}=n,m=e.value.board[g][l];s&&fe(s,m,o),e.value.board[g][l]=w(w({},m),o)}function D(s,e){const{width:n,height:o}=a(e);return[[1,1],[1,0],[1,-1],[0,1],[0,-1],[-1,1],[-1,0],[-1,-1]].map(([g,m])=>({x:s.x+g,y:s.y+m})).filter(({x:g,y:m})=>g>=0&&g<n&&m>=0&&m<o)}function F(s,e,n){const{options:o}=a(e);n.viewed||(!n.dangered&&!n.flagged&&z(s,e,n.position,{viewed:!0}),n.counts===0&&D(n.position,o).forEach(l=>{const g=e.value.board[l.y][l.x];F(s,e,g)}))}function P(s){const{width:e,height:n}=a(s);return Array.from({length:n}).map((o,l)=>Array.from({length:e}).map((g,m)=>({position:{x:m,y:l},counts:0})))}function me(s,e,n){const{options:o}=a(e),{width:l,height:g,mines:m,friendly:c=!1}=o,x=[],C=[n,...c?D(n,o):[]],$=()=>x.splice(Math.floor(Math.random()*x.length),1)[0],h=t=>C.filter(({x:i,y:d})=>t.x===i&&t.y===d).length>0,f=t=>{D(t,o).forEach(i=>{const{counts:d}=e.value.board[i.y][i.x];z(null,e,i,{counts:d+1})})};for(let t=0;t<g;t++)for(let i=0;i<l;i++)h({x:i,y:t})||x.push({x:i,y:t});let r=0;for(;r<m;){const t=$();z(s,e,t,{dangered:!0}),f(t),r++}}function he(s){const{board:e,options:n}=s;let o=n.width*n.height,l=0,g=0;return e.forEach(m=>m.forEach(c=>{if(c.flagged&&l++,c.flagged&&c.dangered||c.viewed)return o--;if(c.dangered)return g++})),M({flags:l,dangers:g,unknowns:o})}function ve(s){const e=Y("minesweeper-state",{options:a(s),timestamp:{begin:0,end:0},status:null,board:P(s)}),n=he(a(e)),o=_(()=>{const{timestamp:h,options:f}=a(e),{flags:r,dangers:t,unknowns:i}=a(n);return{flags:r,dangers:t,unknowns:i,started:h.begin>0,unusedFlags:f.mines-r}}),l=h=>a(e).board[h.y][h.x],g=()=>{const{width:h,height:f}=a(s);n.value={dangers:0,flags:0,unknowns:h*f},e.value.board=P(a(s)),e.value.options=a(s),o.value.started&&(e.value.status=null,e.value.timestamp={begin:0,end:0})},m=h=>{e.value.status=h,e.value.board.forEach(f=>f.forEach(r=>{r.viewed=r.viewed||r.dangered,r.disabled=!0})),e.value.timestamp.end=Date.now()},c=()=>{const{started:h,dangers:f,unknowns:r}=a(o);if(!!h&&(f===0||f===r))return m("win")};return{cache:n,state:e,dashboard:o,reset:g,uncover:h=>{o.value.started||(me(n,e,h),e.value.timestamp.begin=Date.now());const f=l(h);if(!e.value.status&&!f.flagged){if(f.dangered)return m("lose");F(n,e,f),c()}},autoUncover:h=>{const{options:f}=a(e),r=l(h);if(e.value.status||!r.viewed)return;const t=D(r.position,f).map(d=>l(d));let i=0;t.forEach(d=>{d.dangered&&!d.flagged&&i++}),i===0&&t.forEach(d=>F(n,e,d)),c()},mark:h=>{const{mines:f}=a(e).options,r=l(h);e.value.status||r.viewed||o.value.flags>=f&&!r.flagged||(z(n,e,h,{flagged:!r.flagged}),c())}}}const be=u("h2",{text:"5xl center ellipsis",leading:"2em","overflow-hidden":""}," Minesweeper ",-1),pe={"py-4":"",flex:"~ wrap gap-2","justify-center":""},xe=["disabled"],ye={text:"2xl black/75 dark:white/75",flex:"~ gap-4","justify-center":"","items-center":""},we={flex:"~ gap-1","justify-center":"","items-center":""},ke=u("i",{"i-mdi-clock-time-twelve-outline":""},null,-1),_e={flex:"~ gap-1","justify-center":"","items-center":""},Ce=u("i",{"i-mdi-mine":""},null,-1),$e={relative:"","p-4":""},Be={container:"","m-auto":"","text-center":"","overflow-auto":""},Me={"inline-block":""},Ee={key:0,absolute:"","top-0":"","bottom-0":"","left-0":"","right-0":"",flex:"","justify-center":"","items-center":"",bg:"gray-50/50 dark:dark-50/50"},je={fixed:"","top-0":"","left-0":"","z-20":"","w-full":"","h-full":"",bg:"black/50 dark:black/90",flex:"~","justify-center":"","items-center":"","select-none":""},ze={"flex-grow":"","max-w-screen-sm":"","mx-4":"","p-4":"",rounded:"",bg:"white/90 dark:white/10"},De=u("div",{"text-2xl":"",leading:"3em"}," Customize Settings ",-1),Ue={flex:"~ gap-1 col"},Ve={flex:"~ gap-1 col"},Fe={flex:"~ gap-1 col"},Se={flex:"~ gap-4","items-center":""},Ge=E(" Friendly: "),Ne={"py-8":"",flex:"~ gap-4","justify-center":""},Ae=T({setup(s){const e=_(()=>({easy:{width:8,height:8,mines:10},medium:{width:16,height:16,mines:40},hard:{width:30,height:16,mines:99}})),n=M(B(w({},a(e).easy),{friendly:!0})),o=ve(n),{state:l,dashboard:g}=o,m=M(!1),c=M(B(w({},a(l).options),{mines:15})),x=_(()=>{const{width:r,height:t,mines:i}=a(c);return Math.round(r*t*i/100)}),C=Z(),$=_(()=>{const{begin:r,end:t}=l.value.timestamp;let i=0;return r&&t&&(i=t-r),r&&!t&&(i=+C.value-r),(i/1e3).toFixed(1)});function h(r){const{counts:t,dangered:i,flagged:d,viewed:U,disabled:y}=r;return{counts:t,dangered:i,flagged:d,viewed:U,disabled:y}}function f(r){const{friendly:t}=a(n);let i={};switch(r){case"easy":case"medium":case"hard":i=B(w({},a(e)[r]),{friendly:t});break;case"customize":i={width:c.value.width,height:c.value.height,mines:x.value,friendly:c.value.friendly};break;default:i=r}if(!te.xl.value&&i.width>i.height){const{width:d}=i;i.width=i.height,i.height=d}m.value=!1,n.value=i,o.reset()}return(r,t)=>{const i=ge;return v(),b("div",{"pb-4":"",onContextmenuCapture:t[11]||(t[11]=d=>d.preventDefault())},[be,u("div",pe,[u("button",{btn:"~ sky",disabled:!a(g).started,onClick:t[0]||(t[0]=d=>f(a(l).options))}," New Game ",8,xe),u("button",{btn:"",onClick:t[1]||(t[1]=d=>f("easy"))}," Easy "),u("button",{btn:"",onClick:t[2]||(t[2]=d=>f("medium"))}," Medium "),u("button",{btn:"",onClick:t[3]||(t[3]=d=>f("hard"))}," Hard "),u("button",{btn:"",onClick:t[4]||(t[4]=d=>m.value=!0)}," Customize ")]),u("div",ye,[u("div",we,[ke,u("span",null,p(a($)),1)]),u("div",_e,[Ce,u("span",null,p(a(g).unusedFlags),1)])]),u("div",$e,[u("div",Be,[u("div",Me,[(v(!0),b(j,null,A(a(l).board,(d,U)=>(v(),b("div",{key:U,"w-auto":"","m-auto":"",flex:"","items-center":""},[(v(!0),b(j,null,A(d,(y,W)=>(v(),ne(i,se({key:W,"flex-shrink-0":""},h(y),{onClick:S=>a(o).uncover(y.position),onDblclick:S=>a(o).autoUncover(y.position),onContextmenu:oe(S=>a(o).mark(y.position),["prevent"])}),null,16,["onClick","onDblclick","onContextmenu"]))),128))]))),128))])]),a(l).status?(v(),b("div",Ee,[u("span",{text:"8xl shadow","select-none":"",class:L({"text-white/10 dark:text-white/20":a(l).status==="lose","text-orange-400/50 dark:text-orange-400/50":a(l).status==="win"})},p(a(l).status.toUpperCase()),3)])):q("",!0)]),k(u("div",je,[u("div",ze,[De,u("label",Ue,[E(" Width: "+p(c.value.width)+" ",1),k(u("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>c.value.width=d),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[V,c.value.width,void 0,{number:!0}]])]),u("label",Ve,[E(" Height: "+p(c.value.height)+" ",1),k(u("input",{"onUpdate:modelValue":t[6]||(t[6]=d=>c.value.height=d),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[V,c.value.height,void 0,{number:!0}]])]),u("label",Fe,[E(" Mines: "+p(a(x))+" ("+p(c.value.mines)+"%) ",1),k(u("input",{"onUpdate:modelValue":t[7]||(t[7]=d=>c.value.mines=d),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"15",max:"80"},null,512),[[V,c.value.mines,void 0,{number:!0}]])]),u("label",Se,[Ge,k(u("input",{"onUpdate:modelValue":t[8]||(t[8]=d=>c.value.friendly=d),p:"2",bg:"gray-500/10",text:"red-200",type:"checkbox"},null,512),[[ee,c.value.friendly]])]),u("div",Ne,[u("button",{btn:"~ sky",onClick:t[9]||(t[9]=d=>f("customize"))}," Confirm "),u("button",{btn:"solid-sky",onClick:t[10]||(t[10]=d=>m.value=!1)}," Cancel ")])])],512),[[O,m.value]])],32)}}});typeof H=="function"&&H(Ae);export{Ae as default};
