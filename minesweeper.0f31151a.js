var I=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var A=(o,e,t)=>e in o?I(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,y=(o,e)=>{for(var t in e||(e={}))O.call(e,t)&&A(o,t,e[t]);if(G)for(var t of G(e))Q.call(e,t)&&A(o,t,e[t]);return o},C=(o,e)=>J(o,K(e));import{c as X,_ as Y}from"./utils.0e06db65.js";import{d as U,e as j,o as v,c as b,F as V,t as w,u as i,i as Z,f as L,n as R,a as s,r as H,g as ee,m as te,w as ne,h as oe,j as se,k as $,l as ie,p as E,v as ae,q as le,s as P,x as F,y as re,b as T,z as M,A as S,B as de}from"./assets/index.4db1de3d.js";const ue=["disabled"],ce={key:0,"i-mdi-flag":"","text-red-500":""},ge={key:1,"i-mdi-mine":""},fe={key:2},me={key:0,text:"gray-500/50","i-mdi-mine":""},pe={key:1,text:"gray-500/50","i-mdi-flag":"","text-red-500":""},he={key:2,text:"gray-500/50"},ve=U({props:{position:{default:()=>({x:0,y:0})},counts:{default:0},dangered:{type:Boolean},flagged:{type:Boolean},viewed:{type:Boolean},disabled:{type:Boolean}},setup(o){const e=o,t=j(()=>{const a=[],l=["text-transparent","text-indigo-600","text-blue-600","text-teal-600","text-green-600","text-yellow-600","text-amber-600","text-orange-600","text-red-600"];return e.viewed?e.dangered?a.push("bg-red-500/50"):a.push(l[e.counts]):(a.push("bg-gray-500"),e.flagged||a.push("hover:bg-opacity-20 active:bg-opacity-25")),a});return(a,l)=>(v(),b("button",{m:"1px",border:"0.5 gray-400/10","bg-opacity-10":"","inline-block":"","min-w-10":"","min-h-10":"","rounded-sm":"",flex:"","justify-center":"","items-center":"","text-xl":"","font-bold":"","select-none":"","disabled:pointer-events-none":"",disabled:o.disabled,class:R(i(t))},[o.viewed||o.flagged?(v(),b(V,{key:0},[o.flagged?(v(),b("i",ce)):o.dangered?(v(),b("i",ge)):(v(),b("span",fe,w(o.counts),1))],64)):i(Z)?(v(),b(V,{key:1},[o.dangered?(v(),b("i",me)):o.flagged?(v(),b("i",pe)):(v(),b("span",he,w(o.counts),1))],64)):L("",!0)],10,ue))}}),be={relative:"","p-6":""},xe={"text-center":"","overflow-auto":""},ye={"inline-block":""},ke={key:0,absolute:"","top-0":"","bottom-0":"","left-0":"","right-0":"",flex:"","justify-center":"","items-center":"",bg:"gray-50/50 dark:dark-50/50"},we=U({props:{status:null,board:{default:()=>[]}},emits:["click","dblclick","contextmenu"],setup(o,{emit:e}){return(t,a)=>{const l=ve;return v(),b("div",be,[s("div",xe,[s("div",ye,[(v(!0),b(V,null,H(o.board,(r,d)=>(v(),b("div",{key:d,"w-auto":"","m-auto":"",flex:"","items-center":""},[(v(!0),b(V,null,H(r,(u,_)=>(v(),ee(l,te({key:_,"flex-shrink-0":""},u,{onClick:k=>e("click",u.position),onDblclick:k=>e("dblclick",u.position),onContextmenu:ne(k=>e("contextmenu",u.position),["prevent"])}),null,16,["onClick","onDblclick","onContextmenu"]))),128))]))),128))]),o.status?(v(),b("div",ke,[s("span",{text:"8xl shadow","select-none":"",class:R({"text-white/10 dark:text-white/20":o.status==="lose","text-orange-400/50 dark:text-orange-400/50":o.status==="win"})},w(o.status.toUpperCase()),3)])):L("",!0)])])}}}),_e={text:"2xl black/75 dark:white/75",flex:"~ gap-4","justify-center":"","items-center":""},Ce={flex:"~ gap-1","justify-center":"","items-center":""},$e=s("i",{"i-mdi-clock-time-twelve-outline":""},null,-1),ze={"text-lg":"","self-end":""},Ee={flex:"~ gap-1","justify-center":"","items-center":""},Me=s("i",{"i-mdi-mine":""},null,-1),Ve=U({props:{begin:null,end:null,unusedFlags:null},setup(o){const e=o,t=oe(),a=j(()=>{const{begin:l,end:r}=e;let d=0;return l&&r&&(d=r-l),l&&!r&&(d=+t.value-l),(d/1e3).toFixed(2).split(".")});return(l,r)=>(v(),b("div",_e,[s("div",Ce,[$e,s("div",null,[s("span",null,w(i(a)[0]),1),s("span",ze,"."+w(i(a)[1]),1)])]),s("div",Ee,[Me,s("div",null,w(o.unusedFlags),1)])]))}});function Be(o,e,t){let{flags:a,dangers:l,unknowns:r}=i(o);"flagged"in t&&(a+=e.flagged?-1:1),"flagged"in t&&e.dangered&&(r-=t.flagged?1:-1,l-=t.flagged?1:-1),"viewed"in t&&!e.viewed&&r--,"dangered"in t&&(l+=t.dangered?1:-1),o.value=C(y({},i(o)),{flags:a,dangers:l,unknowns:r})}function B(o,e,t,a){const{x:l,y:r}=t,d=e.value.board[r][l];o&&Be(o,d,a),e.value.board[r][l]=y(y({},d),a)}function D(o,e){const{width:t,height:a}=i(e);return[[1,1],[1,0],[1,-1],[0,1],[0,-1],[-1,1],[-1,0],[-1,-1]].map(([r,d])=>({x:o.x+r,y:o.y+d})).filter(({x:r,y:d})=>r>=0&&r<t&&d>=0&&d<a)}function N(o,e,t){const{options:a}=i(e);t.viewed||(!t.dangered&&!t.flagged&&B(o,e,t.position,{viewed:!0}),t.counts===0&&D(t.position,a).forEach(l=>{const r=e.value.board[l.y][l.x];N(o,e,r)}))}function q(o){const{width:e,height:t}=i(o);return Array.from({length:t}).map((a,l)=>Array.from({length:e}).map((r,d)=>({position:{x:d,y:l},counts:0})))}function De(o,e,t){const{options:a}=i(e),{width:l,height:r,mines:d,friendly:u=!1}=a,_=[],k=[t,...u?D(t,a):[]],h=X(o.value.seed),c=()=>_.splice(Math.floor(h()*_.length),1)[0],f=n=>k.some(({x:g,y:z})=>n.x===g&&n.y===z),m=n=>{D(n,a).forEach(g=>{const{counts:z}=e.value.board[g.y][g.x];B(null,e,g,{counts:z+1})})};for(let n=0;n<r;n++)for(let g=0;g<l;g++)f({x:g,y:n})||_.push({x:g,y:n});let p=0;for(;p<d;){const n=c();B(o,e,n,{dangered:!0}),m(n),p++}}function Ue(o){const{board:e,options:t}=o;let a=t.width*t.height,l=0,r=0;return e.forEach(d=>d.forEach(u=>{if(u.flagged&&l++,u.flagged&&u.dangered||u.viewed)return a--;if(u.dangered)return r++})),$({seed:t.seed,flags:l,dangers:r,unknowns:a})}function je(o){const e=se("minesweeper-state",{options:i(o),timestamp:{begin:0,end:0},status:null,board:q(o)}),t=Ue(i(e)),a=j(()=>{const{timestamp:c,options:f}=i(e),{flags:m,dangers:p,unknowns:n}=i(t);return{flags:m,dangers:p,unknowns:n,started:c.begin>0,unusedFlags:f.mines-m}}),l=c=>i(e).board[c.y][c.x],r=()=>{const{options:c}=i(e);t.value=C(y({},i(t)),{dangers:0,flags:0,unknowns:c.width*c.height}),e.value=C(y({},i(e)),{board:q(i(e).options),status:null,timestamp:{begin:0,end:0}})},d=c=>{e.value.status=c,e.value.board.forEach(f=>f.forEach(m=>{m.viewed=m.viewed||m.dangered,m.disabled=!0})),e.value.timestamp.end=Date.now()},u=()=>{const{started:c,dangers:f,unknowns:m}=i(a);if(!!c&&(f===0||f===m))return d("win")};return{cache:t,state:e,dashboard:a,reset:r,uncover:c=>{a.value.started||(De(t,e,c),e.value.timestamp.begin=Date.now());const f=l(c);if(!e.value.status&&!f.flagged){if(f.dangered)return d("lose");N(t,e,f),u()}},autoUncover:c=>{const{options:f}=i(e),m=l(c);if(e.value.status||!m.viewed)return;const p=D(m.position,f).map(g=>l(g));let n=0;p.forEach(g=>{g.dangered&&!g.flagged&&n++}),n===0&&p.forEach(g=>N(t,e,g)),u()},mark:c=>{const{mines:f}=i(e).options,m=l(c);e.value.status||m.viewed||a.value.flags>=f&&!m.flagged||(B(t,e,c,{flagged:!m.flagged}),u())}}}const Fe={"pb-4":""},Se=s("h2",{text:"5xl center ellipsis",leading:"2em","overflow-hidden":""}," Minesweeper ",-1),Ne={"whitespace-nowrap":"","select-none":"",rounded:"",bg:"sky-500 opacity-10 dark:opacity-25",xl:"cursor-move opacity-80 hover:opacity-100 transition duration-250"},Ge={"p-4":"","text-2xl":"","font-bold":"",bg:"dark/10 dark:black/20",flex:"~ gap-2","justify-between":"","items-center":""},Ae=s("span",null,"How to play",-1),He=s("div",{"p-4":"",grid:"~ cols-3 gap-x-8 gap-y-4","auto-cols-auto":"","items-center":""},[s("p",{"col-span-2":""}," Uncover "),s("div",{flex:"","items-center":"","children:flex-shrink-0":""},[s("i",{"i-iconoir-mouse-button-left":"",text:"2xl"})]),s("p",{"col-span-2":""}," Uncover (conditional) "),s("div",{flex:"","items-center":"","children:flex-shrink-0":""},[s("i",{"i-iconoir-mouse-button-left":"",text:"2xl"}),s("i",{"i-iconoir-mouse-button-left":"",text:"2xl"})]),s("p",{"col-span-2":""}," Flagging "),s("div",{flex:"","items-center":"","children:flex-shrink-0":""},[s("i",{"i-iconoir-mouse-button-right":"",text:"2xl"})])],-1),Pe={"py-4":"",flex:"~ wrap gap-2","justify-center":""},Te=["disabled"],qe={flex:"~ gap-1 col"},Le={flex:"~ gap-1 col"},Re={flex:"~ gap-1 col"},We={flex:"~ gap-4","items-center":""},Ie=M(" Friendly: "),Je={"py-8":"",flex:"~ gap-4","justify-center":""},Ke=U({setup(o){const e=$(!0),t=$(null),a=ie(t,{initialValue:{x:200,y:400}}),l={easy:{width:8,height:8,mines:10},medium:{width:16,height:16,mines:40},hard:{width:30,height:16,mines:99}},r=$(C(y({},l.easy),{friendly:!0})),d=je(r),{state:u,dashboard:_}=d,k=$(!1),h=$(C(y({},i(u).options),{mines:15})),c=j(()=>{const{width:p,height:n,mines:g}=i(h);return Math.ceil(p*n*g/100)});function f(p){let n={};switch(p){case"easy":case"medium":case"hard":n=C(y(y({},i(u).options),l[p]),{friendly:!0});break;case"customize":n=C(y(y({},i(u).options),i(h)),{mines:c.value});break;default:n=p}if(!P.xl.value&&n.width>n.height){const{width:g}=n;n.width=n.height,n.height=g}k.value=!1,u.value.options=n,d.reset()}function m(){const{options:p}=i(u),n=Math.floor(p.mines*100/(p.width*p.height));h.value=C(y({},p),{mines:n}),k.value=!0}return(p,n)=>{const g=Ve,z=we,W=Y;return v(),b("div",Fe,[Se,E(s("div",{ref_key:"helpEl",ref:t,relative:"","m-auto":"","p-4":"",xl:"fixed z-5 p-0",style:le(i(P).xl.value?i(a).style.value:"")},[s("div",Ne,[s("div",Ge,[Ae,s("button",{"i-maki-cross":"","icon-button":"","text-2xl":"",xl:"top-5 right-4",onClick:n[0]||(n[0]=x=>e.value=!1)})]),He])],4),[[ae,e.value]]),s("div",Pe,[s("button",{btn:"~ sky",disabled:!i(_).started,onClick:n[1]||(n[1]=x=>f(i(u).options))}," New Game ",8,Te),s("button",{btn:"",onClick:n[2]||(n[2]=x=>f("easy"))}," Easy "),s("button",{btn:"",onClick:n[3]||(n[3]=x=>f("medium"))}," Medium "),s("button",{btn:"",onClick:n[4]||(n[4]=x=>f("hard"))}," Hard "),s("button",{btn:"",onClick:m}," Customize ")]),F(g,{begin:i(u).timestamp.begin,end:i(u).timestamp.end,"unused-flags":i(_).unusedFlags},null,8,["begin","end","unused-flags"]),F(z,{status:i(u).status,board:i(u).board,onClick:i(d).uncover,onDblclick:i(d).autoUncover,onContextmenu:i(d).mark},null,8,["status","board","onClick","onDblclick","onContextmenu"]),F(W,{visible:k.value,title:"Customize Settings",size:"sm"},{default:re(()=>[s("label",qe,[M(" Width: "+w(h.value.width)+" ",1),E(s("input",{"onUpdate:modelValue":n[5]||(n[5]=x=>h.value.width=x),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[S,h.value.width,void 0,{number:!0}]])]),s("label",Le,[M(" Height: "+w(h.value.height)+" ",1),E(s("input",{"onUpdate:modelValue":n[6]||(n[6]=x=>h.value.height=x),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[S,h.value.height,void 0,{number:!0}]])]),s("label",Re,[M(" Mines: "+w(i(c))+" ("+w(h.value.mines)+"%) ",1),E(s("input",{"onUpdate:modelValue":n[7]||(n[7]=x=>h.value.mines=x),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"15",max:"50"},null,512),[[S,h.value.mines,void 0,{number:!0}]])]),s("label",We,[Ie,E(s("input",{"onUpdate:modelValue":n[8]||(n[8]=x=>h.value.friendly=x),bg:"gray-500/10",text:"red-200",type:"checkbox"},null,512),[[de,h.value.friendly]])]),s("div",Je,[s("button",{btn:"~ sky",onClick:n[9]||(n[9]=x=>f("customize"))}," Confirm "),s("button",{btn:"solid-sky",onClick:n[10]||(n[10]=x=>k.value=!1)}," Cancel ")])]),_:1},8,["visible"])])}}});typeof T=="function"&&T(Ke);export{Ke as default};
