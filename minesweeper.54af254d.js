var I=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var A=(t,e,s)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,k=(t,e)=>{for(var s in e||(e={}))Q.call(e,s)&&A(t,s,e[s]);if(N)for(var s of N(e))R.call(e,s)&&A(t,s,e[s]);return t},j=(t,e)=>J(t,K(e));import{d as T,e as $,o as b,c as p,F as B,t as x,u as i,i as X,f as q,n as L,g as Y,r as V,h as Z,a as r,j as G,w as C,v as O,k as E,l as D,m as ee,b as H,p as te,q as ne,s as se,x as oe}from"./assets/index.b8a8bc77.js";const ie=["disabled"],ae={key:0,"i-mdi-flag":"","text-red-500":""},re={key:1,"i-mdi-mine":""},le={key:2},de={key:0,text:"gray-500/50","i-mdi-mine":""},ue={key:1,text:"gray-500/50","i-mdi-flag":"","text-red-500":""},ce={key:2,text:"gray-500/50"},fe=T({props:{counts:{default:0},dangered:{type:Boolean},flagged:{type:Boolean},viewed:{type:Boolean},disabled:{type:Boolean}},setup(t){const e=t,s=$(()=>{const d=[],u=["text-transparent","text-indigo-600","text-blue-600","text-teal-600","text-green-600","text-yellow-600","text-amber-600","text-orange-600","text-red-600"];return e.viewed?e.dangered?d.push("bg-red-500/50"):d.push(u[e.counts]):(d.push("bg-gray-500"),e.flagged||d.push("hover:bg-opacity-20 active:bg-opacity-25")),d});return(d,u)=>(b(),p("button",{m:"1px",border:"0.5 gray-400/10","bg-opacity-10":"","inline-block":"","min-w-10":"","min-h-10":"","rounded-sm":"",flex:"","justify-center":"","items-center":"","text-xl":"","font-bold":"","select-none":"","disabled:pointer-events-none":"",disabled:t.disabled,class:L(i(s))},[t.viewed||t.flagged?(b(),p(B,{key:0},[t.flagged?(b(),p("i",ae)):t.dangered?(b(),p("i",re)):(b(),p("span",le,x(t.counts),1))],64)):i(X)?(b(),p(B,{key:1},[t.dangered?(b(),p("i",de)):t.flagged?(b(),p("i",ue)):(b(),p("span",ce,x(t.counts),1))],64)):q("",!0)],10,ie))}});function z(t,e,s){const{x:d,y:u}=e,v=t.value.board[u][d];t.value.board[u][d]=k(k({},v),s)}function U(t,e){const{width:s,height:d}=i(e);return[[1,1],[1,0],[1,-1],[0,1],[0,-1],[-1,1],[-1,0],[-1,-1]].map(([v,h])=>({x:t.x+v,y:t.y+h})).filter(({x:v,y:h})=>v>=0&&v<s&&h>=0&&h<d)}function F(t,e){const{options:s}=i(t);e.viewed||(!e.dangered&&!e.flagged&&z(t,e.position,{viewed:!0}),e.counts===0&&U(e.position,s).forEach(d=>{const u=t.value.board[d.y][d.x];F(t,u)}))}function P(t){const{width:e,height:s}=i(t);return Array.from({length:s}).map((d,u)=>Array.from({length:e}).map((v,h)=>({position:{x:h,y:u},counts:0})))}function ge(t,e){const{options:s}=i(t),{width:d,height:u,mines:v,friendly:h=!1}=s,f=[],_=()=>f.splice(Math.floor(Math.random()*f.length),1)[0],M=o=>U(e,s).concat(e).filter(({x:a,y:n})=>o.x===a&&o.y===n).length>0,g=o=>{U(o,s).forEach(a=>{const{counts:n}=t.value.board[a.y][a.x];z(t,a,{counts:n+1})})};for(let o=0;o<u;o++)for(let a=0;a<d;a++)h&&M({x:a,y:o})||f.push({x:a,y:o});let m=0;for(;m<v;){const o=_();z(t,o,{dangered:!0}),g(o),m++}}function me(t){const e=Y("minesweeper-state",{options:i(t),timestamp:{begin:0,end:0},status:null,board:P(t)}),s=$(()=>{const{width:g,height:m}=i(e).options,{timestamp:o}=i(e);let a=g*m,n=0,l=0;return e.value.board.forEach(c=>c.forEach(y=>{if(n+=y.flagged?1:0,y.viewed||y.dangered&&y.flagged)return a--;if(y.dangered)return l++})),{started:o.begin>0,flags:n,dangers:l,unknowns:a,unusedFlags:i(e).options.mines-n}}),d=g=>i(e).board[g.y][g.x],u=()=>{e.value.board=P(i(t)),e.value.options=i(t),s.value.started&&(e.value.status=null,e.value.timestamp={begin:0,end:0})},v=g=>{e.value.status=g,e.value.board.forEach(m=>m.forEach(o=>{o.viewed=o.viewed||o.dangered,o.disabled=!0})),e.value.timestamp.end=Date.now()},h=()=>{const{started:g,dangers:m,unknowns:o}=i(s);if(!!g&&(m===0||m===o))return v("win")};return{state:e,dashboard:s,reset:u,uncover:g=>{s.value.started||(ge(e,g),e.value.timestamp.begin=Date.now());const m=d(g);if(!e.value.status&&!m.flagged){if(m.dangered)return v("lose");F(e,m),h()}},autoUncover:g=>{const{options:m}=i(e),o=d(g);if(e.value.status||!o.viewed)return;const a=U(o.position,m).map(l=>d(l));let n=0;a.forEach(l=>{l.dangered&&!l.flagged&&n++}),n===0&&a.forEach(l=>F(e,l)),h()},mark:g=>{const{mines:m}=i(e).options,o=d(g);e.value.status||o.viewed||s.value.flags>=m&&!o.flagged||(z(e,g,{flagged:!o.flagged}),h())}}}const he={"py-8":""},ve=r("h2",{text:"5xl center ellipsis","mb-6":"","overflow-hidden":""}," Minesweeper ",-1),be={flex:"~ wrap gap-2","justify-center":""},pe=["disabled"],ye={"text-center":""},xe={"p-6":"",text:"2xl black/75 dark:white/75",flex:"~ gap-4","justify-center":"","items-center":""},we={flex:"~ gap-1","justify-center":"","items-center":""},ke=r("i",{"i-mdi-clock-time-twelve-outline":""},null,-1),_e={flex:"~ gap-1","justify-center":"","items-center":""},Ce=r("i",{"i-mdi-mine":""},null,-1),$e={relative:"","inline-block":"","max-w-full":"","overflow-auto":""},Be={key:0,absolute:"","top-0":"","left-0":"","right-0":"","bottom-0":"",flex:"","justify-center":"","items-center":"",bg:"gray-50/50 dark:dark-50/50"},Me={fixed:"","top-0":"","left-0":"","z-20":"","w-full":"","h-full":"",bg:"black/50",flex:"~","justify-center":"","items-center":""},je={"flex-grow":"","max-w-screen-sm":"","mx-4":"","p-4":"",rounded:"",bg:"gray-500/20"},Ee=r("div",{"text-2xl":"",leading:"3em"}," Customize Settings ",-1),ze={flex:"~ gap-1 col"},Ue={flex:"~ gap-1 col"},Ve={flex:"~ gap-1 col"},De={flex:"~ gap-4","items-center":""},Fe=E(" Friendly: "),Se={"py-8":"",flex:"~ gap-4","justify-center":""},Ne=T({setup(t){const e=$(()=>({easy:{width:8,height:8,mines:10},medium:{width:16,height:16,mines:40},hard:{width:30,height:16,mines:99}})),s=V(j(k({},i(e).easy),{friendly:!0})),d=me(s),{state:u,dashboard:v}=d,h=V(!1),f=V(j(k({},i(u).options),{mines:15})),_=$(()=>{const{width:a,height:n,mines:l}=i(f);return Math.round(a*n*l/100)}),M=Z(),g=$(()=>{const{begin:a,end:n}=u.value.timestamp;let l=0;return a&&n&&(l=n-a),a&&!n&&(l=+M.value-a),(l/1e3).toFixed(1)});function m(a){const{counts:n,dangered:l,flagged:c,viewed:y,disabled:w}=a;return{counts:n,dangered:l,flagged:c,viewed:y,disabled:w}}function o(a){const{friendly:n}=i(s);let l={};switch(a){case"easy":case"medium":case"hard":l=j(k({},i(e)[a]),{friendly:n});break;case"customize":l={width:f.value.width,height:f.value.height,mines:_.value,friendly:f.value.friendly};break;default:l=a}if(!te.xl.value&&l.width>l.height){const{width:c}=l;l.width=l.height,l.height=c}h.value=!1,s.value=l,d.reset()}return(a,n)=>{const l=fe;return b(),p(B,null,[r("div",he,[ve,r("div",be,[r("button",{btn:"~ sky",disabled:!i(v).started,onClick:n[0]||(n[0]=c=>o(i(u).options))}," New Game ",8,pe),r("button",{btn:"",onClick:n[1]||(n[1]=c=>o("easy"))}," Easy "),r("button",{btn:"",onClick:n[2]||(n[2]=c=>o("medium"))}," Medium "),r("button",{btn:"",onClick:n[3]||(n[3]=c=>o("hard"))}," Hard "),r("button",{btn:"",onClick:n[4]||(n[4]=c=>h.value=!0)}," Customize ")])]),r("div",ye,[r("div",xe,[r("div",we,[ke,r("span",null,x(i(g)),1)]),r("div",_e,[Ce,r("span",null,x(i(v).unusedFlags),1)])]),r("div",$e,[(b(!0),p(B,null,G(i(u).board,(c,y)=>(b(),p("div",{key:y,flex:"~ gap-0","justify-center":""},[(b(!0),p(B,null,G(c,(w,W)=>(b(),ne(l,se({key:W},m(w),{onClick:S=>i(d).uncover(w.position),onDblclick:S=>i(d).autoUncover(w.position),onContextmenu:oe(S=>i(d).mark(w.position),["prevent"])}),null,16,["onClick","onDblclick","onContextmenu"]))),128))]))),128)),i(u).status?(b(),p("div",Be,[r("span",{text:"8xl shadow","select-none":"",class:L({"text-white/10 dark:text-white/20":i(u).status==="lose","text-orange-400/50 dark:text-orange-400/50":i(u).status==="win"})},x(i(u).status.toUpperCase()),3)])):q("",!0)])]),C(r("div",Me,[r("div",je,[Ee,r("label",ze,[E(" Width: "+x(f.value.width)+" ",1),C(r("input",{"onUpdate:modelValue":n[5]||(n[5]=c=>f.value.width=c),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"50"},null,512),[[D,f.value.width,void 0,{number:!0}]])]),r("label",Ue,[E(" Height: "+x(f.value.height)+" ",1),C(r("input",{"onUpdate:modelValue":n[6]||(n[6]=c=>f.value.height=c),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"50"},null,512),[[D,f.value.height,void 0,{number:!0}]])]),r("label",Ve,[E(" Mines: "+x(i(_))+" ("+x(f.value.mines)+"%) ",1),C(r("input",{"onUpdate:modelValue":n[7]||(n[7]=c=>f.value.mines=c),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"15",max:"85"},null,512),[[D,f.value.mines,void 0,{number:!0}]])]),r("label",De,[Fe,C(r("input",{"onUpdate:modelValue":n[8]||(n[8]=c=>f.value.friendly=c),p:"2",bg:"gray-500/10",text:"red-200",type:"checkbox"},null,512),[[ee,f.value.friendly]])]),r("div",Se,[r("button",{btn:"~ sky",onClick:n[9]||(n[9]=c=>o("customize"))}," Confirm "),r("button",{btn:"solid-sky",onClick:n[10]||(n[10]=c=>h.value=!1)}," Cancel ")])])],512),[[O,h.value]])],64)}}});typeof H=="function"&&H(Ne);export{Ne as default};
