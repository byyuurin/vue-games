var W=Object.defineProperty,I=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var N=(t,e,n)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_=(t,e)=>{for(var n in e||(e={}))K.call(e,n)&&N(t,n,e[n]);if(S)for(var n of S(e))Q.call(e,n)&&N(t,n,e[n]);return t},C=(t,e)=>I(t,J(e));import{d as D,e as U,o as b,c as x,F as M,t as k,u as s,i as X,f as L,n as R,a as o,r as G,g as Y,m as Z,w as O,h as ee,j as te,k as E,l as ne,p as $,v as A,q as oe,s as H,x as P,y as z,z as B,A as se,b as T}from"./assets/index.c496a576.js";import{c as ie}from"./utils.0eff9dc5.js";const ae=["disabled"],le={key:0,"i-mdi-flag":"","text-red-500":""},de={key:1,"i-mdi-mine":""},re={key:2},ue={key:0,text:"gray-500/50","i-mdi-mine":""},ce={key:1,text:"gray-500/50","i-mdi-flag":"","text-red-500":""},ge={key:2,text:"gray-500/50"},fe=D({props:{position:{default:()=>({x:0,y:0})},counts:{default:0},dangered:{type:Boolean},flagged:{type:Boolean},viewed:{type:Boolean},disabled:{type:Boolean}},setup(t){const e=t,n=U(()=>{const i=[],a=["text-transparent","text-indigo-600","text-blue-600","text-teal-600","text-green-600","text-yellow-600","text-amber-600","text-orange-600","text-red-600"];return e.viewed?e.dangered?i.push("bg-red-500/50"):i.push(a[e.counts]):(i.push("bg-gray-500"),e.flagged||i.push("hover:bg-opacity-20 active:bg-opacity-25")),i});return(i,a)=>(b(),x("button",{m:"1px",border:"0.5 gray-400/10","bg-opacity-10":"","inline-block":"","min-w-10":"","min-h-10":"","rounded-sm":"",flex:"","justify-center":"","items-center":"","text-xl":"","font-bold":"","select-none":"","disabled:pointer-events-none":"",disabled:t.disabled,class:R(s(n))},[t.viewed||t.flagged?(b(),x(M,{key:0},[t.flagged?(b(),x("i",le)):t.dangered?(b(),x("i",de)):(b(),x("span",re,k(t.counts),1))],64)):s(X)?(b(),x(M,{key:1},[t.dangered?(b(),x("i",ue)):t.flagged?(b(),x("i",ce)):(b(),x("span",ge,k(t.counts),1))],64)):L("",!0)],10,ae))}}),me={relative:"","p-6":""},he={"text-center":"","overflow-auto":""},ve={"inline-block":""},pe={key:0,absolute:"","top-0":"","bottom-0":"","left-0":"","right-0":"",flex:"","justify-center":"","items-center":"",bg:"gray-50/50 dark:dark-50/50"},be=D({props:{status:null,board:{default:()=>[]}},emits:["click","dblclick","contextmenu"],setup(t,{emit:e}){return(n,i)=>{const a=fe;return b(),x("div",me,[o("div",he,[o("div",ve,[(b(!0),x(M,null,G(t.board,(d,u)=>(b(),x("div",{key:u,"w-auto":"","m-auto":"",flex:"","items-center":""},[(b(!0),x(M,null,G(d,(m,w)=>(b(),Y(a,Z({key:w,"flex-shrink-0":""},m,{onClick:y=>e("click",m.position),onDblclick:y=>e("dblclick",m.position),onContextmenu:O(y=>e("contextmenu",m.position),["prevent"])}),null,16,["onClick","onDblclick","onContextmenu"]))),128))]))),128))]),t.status?(b(),x("div",pe,[o("span",{text:"8xl shadow","select-none":"",class:R({"text-white/10 dark:text-white/20":t.status==="lose","text-orange-400/50 dark:text-orange-400/50":t.status==="win"})},k(t.status.toUpperCase()),3)])):L("",!0)])])}}}),xe={text:"2xl black/75 dark:white/75",flex:"~ gap-4","justify-center":"","items-center":""},ye={flex:"~ gap-1","justify-center":"","items-center":""},ke=o("i",{"i-mdi-clock-time-twelve-outline":""},null,-1),we={"text-lg":"","self-end":""},_e={flex:"~ gap-1","justify-center":"","items-center":""},Ce=o("i",{"i-mdi-mine":""},null,-1),$e=D({props:{begin:null,end:null,unusedFlags:null},setup(t){const e=t,n=ee(),i=U(()=>{const{begin:a,end:d}=e;let u=0;return a&&d&&(u=d-a),a&&!d&&(u=+n.value-a),(u/1e3).toFixed(2).split(".")});return(a,d)=>(b(),x("div",xe,[o("div",ye,[ke,o("div",null,[o("span",null,k(s(i)[0]),1),o("span",we,"."+k(s(i)[1]),1)])]),o("div",_e,[Ce,o("div",null,k(t.unusedFlags),1)])]))}});function Ee(t,e,n){let{flags:i,dangers:a,unknowns:d}=s(t);"flagged"in n&&(i+=e.flagged?-1:1),"flagged"in n&&e.dangered&&(d-=n.flagged?1:-1,a-=n.flagged?1:-1),"viewed"in n&&!e.viewed&&d--,"dangered"in n&&(a+=n.dangered?1:-1),t.value=C(_({},s(t)),{flags:i,dangers:a,unknowns:d})}function V(t,e,n,i){const{x:a,y:d}=n,u=e.value.board[d][a];t&&Ee(t,u,i),e.value.board[d][a]=_(_({},u),i)}function j(t,e){const{width:n,height:i}=s(e);return[[1,1],[1,0],[1,-1],[0,1],[0,-1],[-1,1],[-1,0],[-1,-1]].map(([d,u])=>({x:t.x+d,y:t.y+u})).filter(({x:d,y:u})=>d>=0&&d<n&&u>=0&&u<i)}function F(t,e,n){const{options:i}=s(e);n.viewed||(!n.dangered&&!n.flagged&&V(t,e,n.position,{viewed:!0}),n.counts===0&&j(n.position,i).forEach(a=>{const d=e.value.board[a.y][a.x];F(t,e,d)}))}function q(t){const{width:e,height:n}=s(t);return Array.from({length:n}).map((i,a)=>Array.from({length:e}).map((d,u)=>({position:{x:u,y:a},counts:0})))}function ze(t,e,n){const{options:i}=s(e),{width:a,height:d,mines:u,friendly:m=!1}=i,w=[],y=[n,...m?j(n,i):[]],p=ie(t.value.seed),h=()=>w.splice(Math.floor(p()*w.length),1)[0],g=f=>y.some(({x:r,y:v})=>f.x===r&&f.y===v),c=f=>{j(f,i).forEach(r=>{const{counts:v}=e.value.board[r.y][r.x];V(null,e,r,{counts:v+1})})};for(let f=0;f<d;f++)for(let r=0;r<a;r++)g({x:r,y:f})||w.push({x:r,y:f});let l=0;for(;l<u;){const f=h();V(t,e,f,{dangered:!0}),c(f),l++}}function Me(t){const{board:e,options:n}=t;let i=n.width*n.height,a=0,d=0;return e.forEach(u=>u.forEach(m=>{if(m.flagged&&a++,m.flagged&&m.dangered||m.viewed)return i--;if(m.dangered)return d++})),E({seed:n.seed,flags:a,dangers:d,unknowns:i})}function Ve(t){const e=te("minesweeper-state",{options:s(t),timestamp:{begin:0,end:0},status:null,board:q(t)}),n=Me(s(e)),i=U(()=>{const{timestamp:h,options:g}=s(e),{flags:c,dangers:l,unknowns:f}=s(n);return{flags:c,dangers:l,unknowns:f,started:h.begin>0,unusedFlags:g.mines-c}}),a=h=>s(e).board[h.y][h.x],d=()=>{const{width:h,height:g}=s(t);n.value=C(_({},s(n)),{dangers:0,flags:0,unknowns:h*g}),e.value.board=q(s(t)),e.value.options=s(t),i.value.started&&(e.value.status=null,e.value.timestamp={begin:0,end:0})},u=h=>{e.value.status=h,e.value.board.forEach(g=>g.forEach(c=>{c.viewed=c.viewed||c.dangered,c.disabled=!0})),e.value.timestamp.end=Date.now()},m=()=>{const{started:h,dangers:g,unknowns:c}=s(i);if(!!h&&(g===0||g===c))return u("win")};return{cache:n,state:e,dashboard:i,reset:d,uncover:h=>{i.value.started||(ze(n,e,h),e.value.timestamp.begin=Date.now());const g=a(h);if(!e.value.status&&!g.flagged){if(g.dangered)return u("lose");F(n,e,g),m()}},autoUncover:h=>{const{options:g}=s(e),c=a(h);if(e.value.status||!c.viewed)return;const l=j(c.position,g).map(r=>a(r));let f=0;l.forEach(r=>{r.dangered&&!r.flagged&&f++}),f===0&&l.forEach(r=>F(n,e,r)),m()},mark:h=>{const{mines:g}=s(e).options,c=a(h);e.value.status||c.viewed||i.value.flags>=g&&!c.flagged||(V(n,e,h,{flagged:!c.flagged}),m())}}}const je={"pb-4":""},De=o("h2",{text:"5xl center ellipsis",leading:"2em","overflow-hidden":""}," Minesweeper ",-1),Ue={"whitespace-nowrap":"","select-none":"",rounded:"",bg:"sky-500 opacity-10 dark:opacity-25",xl:"cursor-move opacity-80 hover:opacity-100 transition duration-250"},Be={"p-4":"","text-2xl":"","font-bold":"",bg:"dark/10 dark:black/20",flex:"~ gap-2","justify-between":"","items-center":""},Fe=o("span",null,"How to play",-1),Se=o("div",{"p-4":"",grid:"~ cols-3 gap-x-8 gap-y-4","auto-cols-auto":"","items-center":""},[o("p",{"col-span-2":""}," Uncover "),o("div",{flex:"","items-center":"","children:flex-shrink-0":""},[o("i",{"i-iconoir-mouse-button-left":"",text:"2xl"})]),o("p",{"col-span-2":""}," Uncover (conditional) "),o("div",{flex:"","items-center":"","children:flex-shrink-0":""},[o("i",{"i-iconoir-mouse-button-left":"",text:"2xl"}),o("i",{"i-iconoir-mouse-button-left":"",text:"2xl"})]),o("p",{"col-span-2":""}," Flagging "),o("div",{flex:"","items-center":"","children:flex-shrink-0":""},[o("i",{"i-iconoir-mouse-button-right":"",text:"2xl"})])],-1),Ne={"py-4":"",flex:"~ wrap gap-2","justify-center":""},Ge=["disabled"],Ae={fixed:"","top-0":"","left-0":"","z-20":"","w-full":"","h-full":"",bg:"black/50 dark:black/90",flex:"~","justify-center":"","items-center":"","select-none":""},He={"flex-grow":"","max-w-screen-sm":"","mx-4":"","p-4":"",rounded:"",bg:"white/90 dark:white/10"},Pe=o("div",{"text-2xl":"",leading:"3em"}," Customize Settings ",-1),Te={flex:"~ gap-1 col"},qe={flex:"~ gap-1 col"},Le={flex:"~ gap-1 col"},Re={flex:"~ gap-4","items-center":""},We=z(" Friendly: "),Ie={"py-8":"",flex:"~ gap-4","justify-center":""},Je=D({setup(t){const e=E(!0),n=E(null),i=ne(n,{initialValue:{x:200,y:400}}),a={easy:{width:8,height:8,mines:10},medium:{width:16,height:16,mines:40},hard:{width:30,height:16,mines:99}},d=E(C(_({},a.easy),{friendly:!0})),u=Ve(d),{state:m,dashboard:w}=u,y=E(!1),p=E(C(_({},s(m).options),{mines:15})),h=U(()=>{const{width:c,height:l,mines:f}=s(p);return Math.round(c*l*f/100)});function g(c){const{friendly:l,seed:f}=s(d);let r={};switch(c){case"easy":case"medium":case"hard":r=C(_({},a[c]),{friendly:l,seed:f});break;case"customize":r={width:p.value.width,height:p.value.height,mines:h.value,friendly:p.value.friendly,seed:f};break;default:r=c}if(!H.xl.value&&r.width>r.height){const{width:v}=r;r.width=r.height,r.height=v}y.value=!1,d.value=r,u.reset()}return(c,l)=>{const f=$e,r=be;return b(),x("div",je,[De,$(o("div",{ref_key:"helpEl",ref:n,relative:"","m-auto":"","p-4":"",xl:"fixed z-5 p-0",style:oe(s(H).xl.value?s(i).style.value:"")},[o("div",Ue,[o("div",Be,[Fe,o("button",{"i-maki-cross":"","icon-button":"","text-2xl":"",xl:"top-5 right-4",onClick:l[0]||(l[0]=v=>e.value=!1)})]),Se])],4),[[A,e.value]]),o("div",Ne,[o("button",{btn:"~ sky",disabled:!s(w).started,onClick:l[1]||(l[1]=v=>g(s(m).options))}," New Game ",8,Ge),o("button",{btn:"",onClick:l[2]||(l[2]=v=>g("easy"))}," Easy "),o("button",{btn:"",onClick:l[3]||(l[3]=v=>g("medium"))}," Medium "),o("button",{btn:"",onClick:l[4]||(l[4]=v=>g("hard"))}," Hard "),o("button",{btn:"",onClick:l[5]||(l[5]=v=>y.value=!0)}," Customize ")]),P(f,{begin:s(m).timestamp.begin,end:s(m).timestamp.end,"unused-flags":s(w).unusedFlags},null,8,["begin","end","unused-flags"]),P(r,{status:s(m).status,board:s(m).board,onClick:s(u).uncover,onDblclick:s(u).autoUncover,onContextmenu:s(u).mark},null,8,["status","board","onClick","onDblclick","onContextmenu"]),$(o("div",Ae,[o("div",He,[Pe,o("label",Te,[z(" Width: "+k(p.value.width)+" ",1),$(o("input",{"onUpdate:modelValue":l[6]||(l[6]=v=>p.value.width=v),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[B,p.value.width,void 0,{number:!0}]])]),o("label",qe,[z(" Height: "+k(p.value.height)+" ",1),$(o("input",{"onUpdate:modelValue":l[7]||(l[7]=v=>p.value.height=v),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[B,p.value.height,void 0,{number:!0}]])]),o("label",Le,[z(" Mines: "+k(s(h))+" ("+k(p.value.mines)+"%) ",1),$(o("input",{"onUpdate:modelValue":l[8]||(l[8]=v=>p.value.mines=v),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"15",max:"50"},null,512),[[B,p.value.mines,void 0,{number:!0}]])]),o("label",Re,[We,$(o("input",{"onUpdate:modelValue":l[9]||(l[9]=v=>p.value.friendly=v),p:"2",bg:"gray-500/10",text:"red-200",type:"checkbox"},null,512),[[se,p.value.friendly]])]),o("div",Ie,[o("button",{btn:"~ sky",onClick:l[10]||(l[10]=v=>g("customize"))}," Confirm "),o("button",{btn:"solid-sky",onClick:l[11]||(l[11]=v=>y.value=!1)}," Cancel ")])])],512),[[A,y.value]])])}}});typeof T=="function"&&T(Je);export{Je as default};
