var I=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var N=(s,e,t)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,w=(s,e)=>{for(var t in e||(e={}))Q.call(e,t)&&N(s,t,e[t]);if(G)for(var t of G(e))R.call(e,t)&&N(s,t,e[t]);return s},M=(s,e)=>J(s,K(e));import{d as T,e as _,o as v,c as b,F as C,t as p,u as a,i as X,f as q,n as L,g as Y,r as j,h as Z,a as r,j as A,w as k,v as O,k as E,l as D,m as ee,b as H,p as te,q as ne,s as se,x as oe}from"./assets/index.c330ae39.js";const ie=["disabled"],ae={key:0,"i-mdi-flag":"","text-red-500":""},le={key:1,"i-mdi-mine":""},re={key:2},de={key:0,text:"gray-500/50","i-mdi-mine":""},ue={key:1,text:"gray-500/50","i-mdi-flag":"","text-red-500":""},ce={key:2,text:"gray-500/50"},ge=T({props:{counts:{default:0},dangered:{type:Boolean},flagged:{type:Boolean},viewed:{type:Boolean},disabled:{type:Boolean}},setup(s){const e=s,t=_(()=>{const i=[],l=["text-transparent","text-indigo-600","text-blue-600","text-teal-600","text-green-600","text-yellow-600","text-amber-600","text-orange-600","text-red-600"];return e.viewed?e.dangered?i.push("bg-red-500/50"):i.push(l[e.counts]):(i.push("bg-gray-500"),e.flagged||i.push("hover:bg-opacity-20 active:bg-opacity-25")),i});return(i,l)=>(v(),b("button",{m:"1px",border:"0.5 gray-400/10","bg-opacity-10":"","inline-block":"","min-w-10":"","min-h-10":"","rounded-sm":"",flex:"","justify-center":"","items-center":"","text-xl":"","font-bold":"","select-none":"","disabled:pointer-events-none":"",disabled:s.disabled,class:L(a(t))},[s.viewed||s.flagged?(v(),b(C,{key:0},[s.flagged?(v(),b("i",ae)):s.dangered?(v(),b("i",le)):(v(),b("span",re,p(s.counts),1))],64)):a(X)?(v(),b(C,{key:1},[s.dangered?(v(),b("i",de)):s.flagged?(v(),b("i",ue)):(v(),b("span",ce,p(s.counts),1))],64)):q("",!0)],10,ie))}});function fe(s,e,t){let{flags:i,dangers:l,unknowns:f}=a(s);"flagged"in t&&(i+=e.flagged?-1:1),"flagged"in t&&e.dangered&&(f-=t.flagged?1:-1,l-=t.flagged?1:-1),"viewed"in t&&!e.viewed&&f--,"dangered"in t&&(l+=t.dangered?1:-1),s.value={flags:i,dangers:l,unknowns:f}}function z(s,e,t,i){const{x:l,y:f}=t,m=e.value.board[f][l];s&&fe(s,m,i),e.value.board[f][l]=w(w({},m),i)}function U(s,e){const{width:t,height:i}=a(e);return[[1,1],[1,0],[1,-1],[0,1],[0,-1],[-1,1],[-1,0],[-1,-1]].map(([f,m])=>({x:s.x+f,y:s.y+m})).filter(({x:f,y:m})=>f>=0&&f<t&&m>=0&&m<i)}function F(s,e,t){const{options:i}=a(e);t.viewed||(!t.dangered&&!t.flagged&&z(s,e,t.position,{viewed:!0}),t.counts===0&&U(t.position,i).forEach(l=>{const f=e.value.board[l.y][l.x];F(s,e,f)}))}function P(s){const{width:e,height:t}=a(s);return Array.from({length:t}).map((i,l)=>Array.from({length:e}).map((f,m)=>({position:{x:m,y:l},counts:0})))}function me(s,e,t){const{options:i}=a(e),{width:l,height:f,mines:m,friendly:u=!1}=i,y=[],$=()=>y.splice(Math.floor(Math.random()*y.length),1)[0],B=o=>U(t,i).concat(t).filter(({x:n,y:d})=>o.x===n&&o.y===d).length>0,h=o=>{U(o,i).forEach(n=>{const{counts:d}=e.value.board[n.y][n.x];z(null,e,n,{counts:d+1})})};for(let o=0;o<f;o++)for(let n=0;n<l;n++)u&&B({x:n,y:o})||y.push({x:n,y:o});let g=0;for(;g<m;){const o=$();z(s,e,o,{dangered:!0}),h(o),g++}}function he(s){const{board:e,options:t}=s;let i=t.width*t.height,l=0,f=0;return e.forEach(m=>m.forEach(u=>{if(u.flagged&&l++,u.flagged&&u.dangered||u.viewed)return i--;if(u.dangered)return f++})),j({flags:l,dangers:f,unknowns:i})}function ve(s){const e=Y("minesweeper-state",{options:a(s),timestamp:{begin:0,end:0},status:null,board:P(s)}),t=he(a(e)),i=_(()=>{const{timestamp:h,options:g}=a(e),{flags:o,dangers:n,unknowns:d}=a(t);return{flags:o,dangers:n,unknowns:d,started:h.begin>0,unusedFlags:g.mines-o}}),l=h=>a(e).board[h.y][h.x],f=()=>{const{width:h,height:g}=a(s);t.value={dangers:0,flags:0,unknowns:h*g},e.value.board=P(a(s)),e.value.options=a(s),i.value.started&&(e.value.status=null,e.value.timestamp={begin:0,end:0})},m=h=>{e.value.status=h,e.value.board.forEach(g=>g.forEach(o=>{o.viewed=o.viewed||o.dangered,o.disabled=!0})),e.value.timestamp.end=Date.now()},u=()=>{const{started:h,dangers:g,unknowns:o}=a(i);if(!!h&&(g===0||g===o))return m("win")};return{cache:t,state:e,dashboard:i,reset:f,uncover:h=>{i.value.started||(me(t,e,h),e.value.timestamp.begin=Date.now());const g=l(h);if(!e.value.status&&!g.flagged){if(g.dangered)return m("lose");F(t,e,g),u()}},autoUncover:h=>{const{options:g}=a(e),o=l(h);if(e.value.status||!o.viewed)return;const n=U(o.position,g).map(c=>l(c));let d=0;n.forEach(c=>{c.dangered&&!c.flagged&&d++}),d===0&&n.forEach(c=>F(t,e,c)),u()},mark:h=>{const{mines:g}=a(e).options,o=l(h);e.value.status||o.viewed||i.value.flags>=g&&!o.flagged||(z(t,e,h,{flagged:!o.flagged}),u())}}}const be={"py-8":""},pe=r("h2",{text:"5xl center ellipsis","mb-6":"","overflow-hidden":""}," Minesweeper ",-1),ye={flex:"~ wrap gap-2","justify-center":""},xe=["disabled"],we={"text-center":""},ke={"p-6":"",text:"2xl black/75 dark:white/75",flex:"~ gap-4","justify-center":"","items-center":""},_e={flex:"~ gap-1","justify-center":"","items-center":""},Ce=r("i",{"i-mdi-clock-time-twelve-outline":""},null,-1),$e={flex:"~ gap-1","justify-center":"","items-center":""},Be=r("i",{"i-mdi-mine":""},null,-1),Me={relative:"","inline-block":"","max-w-full":"","overflow-auto":""},je={key:0,absolute:"","top-0":"","left-0":"","right-0":"","bottom-0":"",flex:"","justify-center":"","items-center":"",bg:"gray-50/50 dark:dark-50/50"},Ee={fixed:"","top-0":"","left-0":"","z-20":"","w-full":"","h-full":"",bg:"black/50",flex:"~","justify-center":"","items-center":""},ze={"flex-grow":"","max-w-screen-sm":"","mx-4":"","p-4":"",rounded:"",bg:"gray-500/20"},Ue=r("div",{"text-2xl":"",leading:"3em"}," Customize Settings ",-1),Ve={flex:"~ gap-1 col"},De={flex:"~ gap-1 col"},Fe={flex:"~ gap-1 col"},Se={flex:"~ gap-4","items-center":""},Ge=E(" Friendly: "),Ne={"py-8":"",flex:"~ gap-4","justify-center":""},Ae=T({setup(s){const e=_(()=>({easy:{width:8,height:8,mines:10},medium:{width:16,height:16,mines:40},hard:{width:30,height:16,mines:99}})),t=j(M(w({},a(e).easy),{friendly:!0})),i=ve(t),{state:l,dashboard:f}=i,m=j(!1),u=j(M(w({},a(l).options),{mines:15})),y=_(()=>{const{width:o,height:n,mines:d}=a(u);return Math.round(o*n*d/100)}),$=Z(),B=_(()=>{const{begin:o,end:n}=l.value.timestamp;let d=0;return o&&n&&(d=n-o),o&&!n&&(d=+$.value-o),(d/1e3).toFixed(1)});function h(o){const{counts:n,dangered:d,flagged:c,viewed:V,disabled:x}=o;return{counts:n,dangered:d,flagged:c,viewed:V,disabled:x}}function g(o){const{friendly:n}=a(t);let d={};switch(o){case"easy":case"medium":case"hard":d=M(w({},a(e)[o]),{friendly:n});break;case"customize":d={width:u.value.width,height:u.value.height,mines:y.value,friendly:u.value.friendly};break;default:d=o}if(!te.xl.value&&d.width>d.height){const{width:c}=d;d.width=d.height,d.height=c}m.value=!1,t.value=d,i.reset()}return(o,n)=>{const d=ge;return v(),b(C,null,[r("div",be,[pe,r("div",ye,[r("button",{btn:"~ sky",disabled:!a(f).started,onClick:n[0]||(n[0]=c=>g(a(l).options))}," New Game ",8,xe),r("button",{btn:"",onClick:n[1]||(n[1]=c=>g("easy"))}," Easy "),r("button",{btn:"",onClick:n[2]||(n[2]=c=>g("medium"))}," Medium "),r("button",{btn:"",onClick:n[3]||(n[3]=c=>g("hard"))}," Hard "),r("button",{btn:"",onClick:n[4]||(n[4]=c=>m.value=!0)}," Customize ")])]),r("div",we,[r("div",ke,[r("div",_e,[Ce,r("span",null,p(a(B)),1)]),r("div",$e,[Be,r("span",null,p(a(f).unusedFlags),1)])]),r("div",Me,[(v(!0),b(C,null,A(a(l).board,(c,V)=>(v(),b("div",{key:V,flex:"~ gap-0","justify-center":""},[(v(!0),b(C,null,A(c,(x,W)=>(v(),ne(d,se({key:W},h(x),{onClick:S=>a(i).uncover(x.position),onDblclick:S=>a(i).autoUncover(x.position),onContextmenu:oe(S=>a(i).mark(x.position),["prevent"])}),null,16,["onClick","onDblclick","onContextmenu"]))),128))]))),128)),a(l).status?(v(),b("div",je,[r("span",{text:"8xl shadow","select-none":"",class:L({"text-white/10 dark:text-white/20":a(l).status==="lose","text-orange-400/50 dark:text-orange-400/50":a(l).status==="win"})},p(a(l).status.toUpperCase()),3)])):q("",!0)])]),k(r("div",Ee,[r("div",ze,[Ue,r("label",Ve,[E(" Width: "+p(u.value.width)+" ",1),k(r("input",{"onUpdate:modelValue":n[5]||(n[5]=c=>u.value.width=c),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[D,u.value.width,void 0,{number:!0}]])]),r("label",De,[E(" Height: "+p(u.value.height)+" ",1),k(r("input",{"onUpdate:modelValue":n[6]||(n[6]=c=>u.value.height=c),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[D,u.value.height,void 0,{number:!0}]])]),r("label",Fe,[E(" Mines: "+p(a(y))+" ("+p(u.value.mines)+"%) ",1),k(r("input",{"onUpdate:modelValue":n[7]||(n[7]=c=>u.value.mines=c),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"15",max:"85"},null,512),[[D,u.value.mines,void 0,{number:!0}]])]),r("label",Se,[Ge,k(r("input",{"onUpdate:modelValue":n[8]||(n[8]=c=>u.value.friendly=c),p:"2",bg:"gray-500/10",text:"red-200",type:"checkbox"},null,512),[[ee,u.value.friendly]])]),r("div",Ne,[r("button",{btn:"~ sky",onClick:n[9]||(n[9]=c=>g("customize"))}," Confirm "),r("button",{btn:"solid-sky",onClick:n[10]||(n[10]=c=>m.value=!1)}," Cancel ")])])],512),[[O,m.value]])],64)}}});typeof H=="function"&&H(Ae);export{Ae as default};
