var I=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var N=(s,e,t)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,w=(s,e)=>{for(var t in e||(e={}))Q.call(e,t)&&N(s,t,e[t]);if(G)for(var t of G(e))R.call(e,t)&&N(s,t,e[t]);return s},B=(s,e)=>J(s,K(e));import{d as T,e as C,o as v,c as p,F as E,t as b,u as a,i as X,f as q,n as L,g as Y,r as M,h as Z,a as l,j as A,w as k,v as O,k as j,l as V,m as ee,b as H,p as te,q as ne,s as se,x as oe}from"./assets/index.d48f1812.js";const ie=["disabled"],ae={key:0,"i-mdi-flag":"","text-red-500":""},re={key:1,"i-mdi-mine":""},le={key:2},de={key:0,text:"gray-500/50","i-mdi-mine":""},ue={key:1,text:"gray-500/50","i-mdi-flag":"","text-red-500":""},ce={key:2,text:"gray-500/50"},ge=T({props:{counts:{default:0},dangered:{type:Boolean},flagged:{type:Boolean},viewed:{type:Boolean},disabled:{type:Boolean}},setup(s){const e=s,t=C(()=>{const i=[],r=["text-transparent","text-indigo-600","text-blue-600","text-teal-600","text-green-600","text-yellow-600","text-amber-600","text-orange-600","text-red-600"];return e.viewed?e.dangered?i.push("bg-red-500/50"):i.push(r[e.counts]):(i.push("bg-gray-500"),e.flagged||i.push("hover:bg-opacity-20 active:bg-opacity-25")),i});return(i,r)=>(v(),p("button",{m:"1px",border:"0.5 gray-400/10","bg-opacity-10":"","inline-block":"","min-w-10":"","min-h-10":"","rounded-sm":"",flex:"","justify-center":"","items-center":"","text-xl":"","font-bold":"","select-none":"","disabled:pointer-events-none":"",disabled:s.disabled,class:L(a(t))},[s.viewed||s.flagged?(v(),p(E,{key:0},[s.flagged?(v(),p("i",ae)):s.dangered?(v(),p("i",re)):(v(),p("span",le,b(s.counts),1))],64)):a(X)?(v(),p(E,{key:1},[s.dangered?(v(),p("i",de)):s.flagged?(v(),p("i",ue)):(v(),p("span",ce,b(s.counts),1))],64)):q("",!0)],10,ie))}});function fe(s,e,t){let{flags:i,dangers:r,unknowns:f}=a(s);"flagged"in t&&(i+=e.flagged?-1:1),"flagged"in t&&e.dangered&&(f-=t.flagged?1:-1,r-=t.flagged?1:-1),"viewed"in t&&!e.viewed&&f--,"dangered"in t&&(r+=t.dangered?1:-1),s.value={flags:i,dangers:r,unknowns:f}}function z(s,e,t,i){const{x:r,y:f}=t,m=e.value.board[f][r];s&&fe(s,m,i),e.value.board[f][r]=w(w({},m),i)}function D(s,e){const{width:t,height:i}=a(e);return[[1,1],[1,0],[1,-1],[0,1],[0,-1],[-1,1],[-1,0],[-1,-1]].map(([f,m])=>({x:s.x+f,y:s.y+m})).filter(({x:f,y:m})=>f>=0&&f<t&&m>=0&&m<i)}function F(s,e,t){const{options:i}=a(e);t.viewed||(!t.dangered&&!t.flagged&&z(s,e,t.position,{viewed:!0}),t.counts===0&&D(t.position,i).forEach(r=>{const f=e.value.board[r.y][r.x];F(s,e,f)}))}function P(s){const{width:e,height:t}=a(s);return Array.from({length:t}).map((i,r)=>Array.from({length:e}).map((f,m)=>({position:{x:m,y:r},counts:0})))}function me(s,e,t){const{options:i}=a(e),{width:r,height:f,mines:m,friendly:c=!1}=i,y=[],_=()=>y.splice(Math.floor(Math.random()*y.length),1)[0],$=o=>D(t,i).concat(t).filter(({x:n,y:d})=>o.x===n&&o.y===d).length>0,h=o=>{D(o,i).forEach(n=>{const{counts:d}=e.value.board[n.y][n.x];z(null,e,n,{counts:d+1})})};for(let o=0;o<f;o++)for(let n=0;n<r;n++)c&&$({x:n,y:o})||y.push({x:n,y:o});let g=0;for(;g<m;){const o=_();z(s,e,o,{dangered:!0}),h(o),g++}}function he(s){const{board:e,options:t}=s;let i=t.width*t.height,r=0,f=0;return e.forEach(m=>m.forEach(c=>{if(c.flagged&&r++,c.flagged&&c.dangered||c.viewed)return i--;if(c.dangered)return f++})),M({flags:r,dangers:f,unknowns:i})}function ve(s){const e=Y("minesweeper-state",{options:a(s),timestamp:{begin:0,end:0},status:null,board:P(s)}),t=he(a(e)),i=C(()=>{const{timestamp:h,options:g}=a(e),{flags:o,dangers:n,unknowns:d}=a(t);return{flags:o,dangers:n,unknowns:d,started:h.begin>0,unusedFlags:g.mines-o}}),r=h=>a(e).board[h.y][h.x],f=()=>{const{width:h,height:g}=a(s);t.value={dangers:0,flags:0,unknowns:h*g},e.value.board=P(a(s)),e.value.options=a(s),i.value.started&&(e.value.status=null,e.value.timestamp={begin:0,end:0})},m=h=>{e.value.status=h,e.value.board.forEach(g=>g.forEach(o=>{o.viewed=o.viewed||o.dangered,o.disabled=!0})),e.value.timestamp.end=Date.now()},c=()=>{const{started:h,dangers:g,unknowns:o}=a(i);if(!!h&&(g===0||g===o))return m("win")};return{cache:t,state:e,dashboard:i,reset:f,uncover:h=>{i.value.started||(me(t,e,h),e.value.timestamp.begin=Date.now());const g=r(h);if(!e.value.status&&!g.flagged){if(g.dangered)return m("lose");F(t,e,g),c()}},autoUncover:h=>{const{options:g}=a(e),o=r(h);if(e.value.status||!o.viewed)return;const n=D(o.position,g).map(u=>r(u));let d=0;n.forEach(u=>{u.dangered&&!u.flagged&&d++}),d===0&&n.forEach(u=>F(t,e,u)),c()},mark:h=>{const{mines:g}=a(e).options,o=r(h);e.value.status||o.viewed||i.value.flags>=g&&!o.flagged||(z(t,e,h,{flagged:!o.flagged}),c())}}}const pe=l("h2",{text:"5xl center ellipsis",leading:"2em","overflow-hidden":""}," Minesweeper ",-1),be={"py-4":"",flex:"~ wrap gap-2","justify-center":""},ye=["disabled"],xe={text:"2xl black/75 dark:white/75",flex:"~ gap-4","justify-center":"","items-center":""},we={flex:"~ gap-1","justify-center":"","items-center":""},ke=l("i",{"i-mdi-clock-time-twelve-outline":""},null,-1),Ce={flex:"~ gap-1","justify-center":"","items-center":""},_e=l("i",{"i-mdi-mine":""},null,-1),$e={relative:"","p-4":""},Be={"overflow-auto":""},Me={key:0,absolute:"","top-0":"","bottom-0":"","left-0":"","right-0":"",flex:"","justify-center":"","items-center":"",bg:"gray-50/50 dark:dark-50/50"},je={fixed:"","top-0":"","left-0":"","z-20":"","w-full":"","h-full":"",bg:"black/50",flex:"~","justify-center":"","items-center":""},Ee={"flex-grow":"","max-w-screen-sm":"","mx-4":"","p-4":"",rounded:"",bg:"gray-500/20"},ze=l("div",{"text-2xl":"",leading:"3em"}," Customize Settings ",-1),De={flex:"~ gap-1 col"},Ue={flex:"~ gap-1 col"},Ve={flex:"~ gap-1 col"},Fe={flex:"~ gap-4","items-center":""},Se=j(" Friendly: "),Ge={"py-8":"",flex:"~ gap-4","justify-center":""},Ne=T({setup(s){const e=C(()=>({easy:{width:8,height:8,mines:10},medium:{width:16,height:16,mines:40},hard:{width:30,height:16,mines:99}})),t=M(B(w({},a(e).easy),{friendly:!0})),i=ve(t),{state:r,dashboard:f}=i,m=M(!1),c=M(B(w({},a(r).options),{mines:15})),y=C(()=>{const{width:o,height:n,mines:d}=a(c);return Math.round(o*n*d/100)}),_=Z(),$=C(()=>{const{begin:o,end:n}=r.value.timestamp;let d=0;return o&&n&&(d=n-o),o&&!n&&(d=+_.value-o),(d/1e3).toFixed(1)});function h(o){const{counts:n,dangered:d,flagged:u,viewed:U,disabled:x}=o;return{counts:n,dangered:d,flagged:u,viewed:U,disabled:x}}function g(o){const{friendly:n}=a(t);let d={};switch(o){case"easy":case"medium":case"hard":d=B(w({},a(e)[o]),{friendly:n});break;case"customize":d={width:c.value.width,height:c.value.height,mines:y.value,friendly:c.value.friendly};break;default:d=o}if(!te.xl.value&&d.width>d.height){const{width:u}=d;d.width=d.height,d.height=u}m.value=!1,t.value=d,i.reset()}return(o,n)=>{const d=ge;return v(),p("div",{"pb-4":"",onContextmenuCapture:n[11]||(n[11]=u=>u.preventDefault())},[pe,l("div",be,[l("button",{btn:"~ sky",disabled:!a(f).started,onClick:n[0]||(n[0]=u=>g(a(r).options))}," New Game ",8,ye),l("button",{btn:"",onClick:n[1]||(n[1]=u=>g("easy"))}," Easy "),l("button",{btn:"",onClick:n[2]||(n[2]=u=>g("medium"))}," Medium "),l("button",{btn:"",onClick:n[3]||(n[3]=u=>g("hard"))}," Hard "),l("button",{btn:"",onClick:n[4]||(n[4]=u=>m.value=!0)}," Customize ")]),l("div",xe,[l("div",we,[ke,l("span",null,b(a($)),1)]),l("div",Ce,[_e,l("span",null,b(a(f).unusedFlags),1)])]),l("div",$e,[l("div",Be,[(v(!0),p(E,null,A(a(r).board,(u,U)=>(v(),p("div",{key:U,flex:"~ gap-0","justify-center":""},[(v(!0),p(E,null,A(u,(x,W)=>(v(),ne(d,se({key:W,"flex-shrink-0":""},h(x),{onClick:S=>a(i).uncover(x.position),onDblclick:S=>a(i).autoUncover(x.position),onContextmenu:oe(S=>a(i).mark(x.position),["prevent"])}),null,16,["onClick","onDblclick","onContextmenu"]))),128))]))),128))]),a(r).status?(v(),p("div",Me,[l("span",{text:"8xl shadow","select-none":"",class:L({"text-white/10 dark:text-white/20":a(r).status==="lose","text-orange-400/50 dark:text-orange-400/50":a(r).status==="win"})},b(a(r).status.toUpperCase()),3)])):q("",!0)]),k(l("div",je,[l("div",Ee,[ze,l("label",De,[j(" Width: "+b(c.value.width)+" ",1),k(l("input",{"onUpdate:modelValue":n[5]||(n[5]=u=>c.value.width=u),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[V,c.value.width,void 0,{number:!0}]])]),l("label",Ue,[j(" Height: "+b(c.value.height)+" ",1),k(l("input",{"onUpdate:modelValue":n[6]||(n[6]=u=>c.value.height=u),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"4",max:"30"},null,512),[[V,c.value.height,void 0,{number:!0}]])]),l("label",Ve,[j(" Mines: "+b(a(y))+" ("+b(c.value.mines)+"%) ",1),k(l("input",{"onUpdate:modelValue":n[7]||(n[7]=u=>c.value.mines=u),p:"2",bg:"gray-500/10",text:"red-200",type:"range",min:"15",max:"85"},null,512),[[V,c.value.mines,void 0,{number:!0}]])]),l("label",Fe,[Se,k(l("input",{"onUpdate:modelValue":n[8]||(n[8]=u=>c.value.friendly=u),p:"2",bg:"gray-500/10",text:"red-200",type:"checkbox"},null,512),[[ee,c.value.friendly]])]),l("div",Ge,[l("button",{btn:"~ sky",onClick:n[9]||(n[9]=u=>g("customize"))}," Confirm "),l("button",{btn:"solid-sky",onClick:n[10]||(n[10]=u=>m.value=!1)}," Cancel ")])])],512),[[O,m.value]])],32)}}});typeof H=="function"&&H(Ne);export{Ne as default};
